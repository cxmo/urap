# changes to previous approach 
# section by companies first 

# cleaning up companies 
company = my.emp.df$company.tokens 
company.tb = table(company)[order(table(company), decreasing = T)]

# accenture, bain, deloitte, boston consulting, allen booz hamilton, 
# earnst young, mckinsey, pwc, capgemini, kpmg, oliver wyman, anderson arthur 
# consultancy services tata, bearingpoint, associates zs

find.company = function(company.string, data = company){ 
  company.name = grep(company.string, data) 
  company.name.df = my.emp.df[company.name,]
  return(company.name.df)
} 

accenture = find.company("accenture") 
bain = find.company("bain") 
deloitte = find.company("deloitte") 
boston.consulting = find.company("boston.consulting") 
booz = find.company("booz") 
ey = find.company("earnst young | ey") 
mckinsey = find.company("mckinsey") 
pwc = find.company("pwc | price") 
capgemini = find.company("capgemini") 
kpmg = find.company("kpmg")
oliver.wyman = find.company("wyman") 
andersen.arthur = find.company("andersen") 
tata = find.company("tata") 
bearingpoint = find.company("bearingpoint") 
associates.zs = find.company("associates zs") 

consulting.data = list(accenture, bain, deloitte, boston.consulting, 
booz, ey, mckinsey, pwc, capgemini, kpmg, oliver.wyman, andersen.arthur, 
tata, bearingpoint, associates.zs)

find.employee = function(x) { 
  return(data.frame(x, x$end - x$start))
}

info.list = lapply(consulting.data, find.employee)
info.list.new = info.list 

### average number of years in position ### 
# functions 
find.table = function(dataset) { 
  title.tokens = dataset$title.tokens
  return(table(title.tokens)[order(table(title.tokens), decreasing = T)])
}

top.titles = lapply(info.list.new, find.table)
titles.split = lapply(info.list.new, function(x) 
                      {x.dataframe = split(x, x$title.tokens);
                       empty_vector = 1:length(x.dataframe); 
                       for(i in 1:length(x.dataframe)){  
                          current_dataframe = x.dataframe[[i]] 
                          empty_vector[i] = mean(current_dataframe$x.end...x.start)
                       }
                       return(data.frame(names(x.dataframe), empty_vector))})
